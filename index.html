<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IVL VIP SYSTEM</title>

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&family=Orbitron:wght@700;900&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#020205;
  --card:#0b0f14;
  --green:#00ff88;
  --border:rgba(0,255,136,.35);
}
body{
  font-family:'Cairo',sans-serif;
  background:radial-gradient(circle at top right,#003d2a,transparent),var(--bg);
  color:white;
}
.orbitron{font-family:'Orbitron',sans-serif}
.card{
  background:var(--card);
  border:2px solid var(--border);
  border-radius:22px;
  box-shadow:0 0 30px rgba(0,255,136,.15);
  padding:16px;
}
.input, textarea, select{
  background:#05070c;
  border:1px solid var(--border);
  padding:12px;
  border-radius:14px;
  color:white;
  width:100%;
}
.input:focus, textarea:focus, select:focus{outline:none;border-color:var(--green)}
.btn{
  background:linear-gradient(135deg,var(--green),#00c26e);
  color:black;
  font-weight:900;
  padding:12px;
  border-radius:14px;
  width:100%;
}
.btn:hover{opacity:.9;transform:translateY(-2px);transition:0.2s}
.modal{
  position:fixed;
  top:0;left:0;width:100%;height:100%;
  background:rgba(0,0,0,.6);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:9999;
}
.modal-box{
  background:var(--card);
  border:2px solid var(--green);
  border-radius:16px;
  padding:20px;
  max-width:350px;
  text-align:center;
}
.modal-box h2{color:var(--green);margin-bottom:12px}
.modal-box button{
  padding:6px 14px;
  margin:0 4px;
  border:none;
  border-radius:8px;
  font-weight:bold;
  font-size:0.85rem;
  cursor:pointer;
}
#announcement{
  background:rgba(0,255,136,0.1);
  border:1px solid var(--green);
  border-radius:12px;
  padding:10px;
  text-align:right;
  direction:rtl;
  font-weight:bold;
  color:var(--green);
  margin-bottom:10px;
  word-break: break-word;
}
</style>
</head>

<body class="p-4">

<!-- AUTH -->
<div id="auth" class="min-h-screen flex items-center justify-center">
  <div class="card w-full max-w-md space-y-4 text-center">
    <h1 class="orbitron text-4xl text-green">IVL VIP</h1>

    <input id="loginUser" class="input" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
    <input id="loginPass" type="password" class="input" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±">
    <button onclick="login()" class="btn">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>

    <hr class="border border-green/20 my-2">

    <div class="text-xs opacity-50">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</div>
    <input id="ru" class="input text-sm" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
    <input id="rp" type="password" class="input text-sm" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±">
    <input id="rc" class="input text-sm" placeholder="Ø§Ø³Ù… Ø§Ù„Ø´Ø®ØµÙŠØ©">
    <input id="rg" class="input text-sm" placeholder="Ø§Ø³Ù… Ø§Ù„Ù†Ù‚Ø§Ø¨Ø©">
    <button onclick="register()" class="btn text-sm">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</button>
  </div>
</div>

<!-- APP -->
<div id="app" class="hidden max-w-6xl mx-auto space-y-4">

<div id="announcement"></div>

<header class="card flex justify-between items-center">
  <div>
    <h2 id="meChar" class="text-xl font-black"></h2>
    <p id="meGuild" class="text-xs text-green"></p>
  </div>
  <div>
    <div class="text-xs opacity-60">Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø§Ø·</div>
    <div id="mePoints" class="orbitron text-2xl text-green"></div>
  </div>
</header>

<!-- Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù† -->
<div id="adminPanel" class="hidden space-y-4">

  <div class="card">
    <h4 class="text-green font-bold">ğŸ“¢ ÙƒØªØ§Ø¨Ø© Ø¥Ø¹Ù„Ø§Ù†</h4>
    <textarea id="announceInput" class="input mb-2" placeholder="Ø§ÙƒØªØ¨ Ù†Øµ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ù‡Ù†Ø§"></textarea>
    <button onclick="updateAnnouncement()" class="btn text-sm">Ù†Ø´Ø± Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†</button>
  </div>

  <div class="card">
    <h4 class="text-green font-bold">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù†Ù‚Ø§Ø·</h4>
    <select id="pointUser" class="input mb-2"></select>
    <input id="pointAmount" class="input mb-2" placeholder="Ø¹Ø¯Ø¯ Ø§Ù„Ù†Ù‚Ø§Ø·">
    <div class="flex gap-2">
      <button onclick="confirmAction('addPoints')" class="btn text-sm">Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø§Ø·</button>
      <button onclick="confirmAction('removePoints')" class="btn text-sm">Ø­Ø°Ù Ù†Ù‚Ø§Ø·</button>
    </div>
  </div>

  <div class="card">
    <h4 class="text-green font-bold">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø³Ù„Ø¹</h4>
    <input id="itemName" class="input mb-2" placeholder="Ø§Ø³Ù… Ø§Ù„Ø³Ù„Ø¹Ø©">
    <input id="itemPrice" class="input mb-2" placeholder="Ø§Ù„Ø³Ø¹Ø±">
    <input id="itemCategory" class="input mb-2" placeholder="Ø§Ù„ÙØ¦Ø©">
    <button onclick="confirmAction('addItem')" class="btn text-sm">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø³Ù„Ø¹Ø©</button>
  </div>

  <div class="card">
    <h4 class="text-green font-bold">ğŸ† Ø£Ø¹Ù„Ù‰ 3 Ù„Ø§Ø¹Ø¨ÙŠÙ†</h4>
    <div id="topUsers" class="text-sm space-y-1"></div>
  </div>

  <div class="card">
    <h4 class="text-red-500 font-bold">ğŸ—‘ï¸ Ø­Ø°Ù Ø­Ø³Ø§Ø¨ Ø¹Ø¶Ùˆ</h4>
    <select id="deleteUserSelect" class="input mb-2"></select>
    <button onclick="deleteUser()" class="btn text-sm bg-red-500 hover:bg-red-600">Ø­Ø°Ù Ø§Ù„Ø­Ø³Ø§Ø¨</button>
  </div>

  <!-- LOGS -->
  <div class="card">
    <h4 class="text-green font-bold">ğŸ“œ Ø³Ø¬Ù„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª</h4>
    <div id="logsBox" class="text-xs max-h-64 overflow-auto"></div>
  </div>

</div>

<div class="card">
  <h3 class="text-green mb-2">ğŸ›’ Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ù…ØªØ§Ø­Ø©</h3>
  <div id="market" class="grid sm:grid-cols-2 gap-4"></div>
</div>

</div>

<!-- MODAL -->
<div id="modal" class="modal hidden">
  <div class="modal-box">
    <h2 id="modalTitle"></h2>
    <p id="modalText" class="mb-4"></p>
    <div>
      <button id="modalConfirm" class="btn">ØªØ£ÙƒÙŠØ¯</button>
      <button id="modalCancel" class="btn">Ø¥Ù„ØºØ§Ø¡</button>
    </div>
  </div>
</div>

<script>
/* ===== DATA ===== */
let db = JSON.parse(localStorage.getItem("ivl-db"));
if(!db || !db.users){
  db={users:[{id:1,user:"admin",pass:"5365360",char:"ADMIN",guild:"IVL ROOT",points:999999,role:"admin"}],items:[],announcement:"Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨ÙƒÙ…!",logs:[]};
  localStorage.setItem("ivl-db",JSON.stringify(db));
}
if(!db.logs) db.logs=[];
let session=null;

/* ===== LOGS ===== */
function addLog(text){
  db.logs.unshift({time:new Date().toLocaleString("ar"),by:session?session.char:"SYSTEM",action:text});
  localStorage.setItem("ivl-db",JSON.stringify(db));
  renderLogs();
}
function renderLogs(){
  if(!logsBox) return;
  logsBox.innerHTML=db.logs.slice(0,5).map(l=>`<div class="border-b border-green/20 pb-1 mb-1"><div class="opacity-60">${l.time}</div><div>${l.by} âœ ${l.action}</div></div>`).join("");
}

/* ===== AUTH ===== */
function login(){const u=loginUser.value.trim();const p=loginPass.value.trim();const f=db.users.find(x=>x.user===u&&x.pass===p);if(!f){alert("âŒ Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ØµØ­ÙŠØ­Ø©");return;}session=f;init();addLog("ğŸ”‘ ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„");}
function register(){const u=ru.value.trim(),p=rp.value.trim(),c=rc.value.trim(),g=rg.value.trim();if(!u||!p||!c||!g){alert("Ø£ÙƒÙ…Ù„ ÙƒÙ„ Ø§Ù„Ø­Ù‚ÙˆÙ„");return;}if(db.users.find(x=>x.user===u)){alert("Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…ÙˆØ¬ÙˆØ¯");return;}db.users.push({id:Date.now(),user:u,pass:p,char:c,guild:g,points:0,role:"member"});localStorage.setItem("ivl-db",JSON.stringify(db));alert("âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨");addLog(`ğŸ†• Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ ${c}`);}

/* ===== INIT ===== */
function init(){
  auth.classList.add("hidden");
  app.classList.remove("hidden");
  meChar.textContent=session.char;
  meGuild.textContent=session.guild;
  mePoints.textContent=session.points;
  announcement.textContent=db.announcement||"";
  if(session.role==="admin"){
    adminPanel.classList.remove("hidden");
    updatePointUsers();
    updateTopUsers();
    updateDeleteUserList();
    renderLogs();
  }
  renderMarket();
}

/* ===== Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø¯ÙˆØ§Ù„ ===== */
function updateAnnouncement(){const text=announceInput.value.trim();if(!text){alert("Ø§ÙƒØªØ¨ Ù†Øµ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†");return;}db.announcement=text;localStorage.setItem("ivl-db",JSON.stringify(db));announcement.textContent=text;announceInput.value="";addLog(`ğŸ“¢ ØªÙ… Ù†Ø´Ø± Ø¥Ø¹Ù„Ø§Ù†: ${text}`);}
function updatePointUsers(){pointUser.innerHTML=db.users.map(u=>`<option value="${u.id}">${u.char} (${u.user})</option>`).join("");}
function updateTopUsers(){const top=db.users.slice().sort((a,b)=>b.points-a.points).slice(0,3);topUsers.innerHTML=top.map((u,i)=>`${i+1}. ${u.char} - ${u.points} Ù†Ù‚Ø·Ø©`).join("<br>");}
function updateDeleteUserList(){deleteUserSelect.innerHTML=db.users.filter(u=>u.role!=="admin").map(u=>`<option value="${u.id}">${u.char} (${u.user})</option>`).join("");}
function deleteUser(){const uid=+deleteUserSelect.value;if(!uid){alert("Ø§Ø®ØªØ± Ø­Ø³Ø§Ø¨Ù‹Ø§ Ù„Ù„Ø­Ø°Ù");return;}if(!confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø­Ø³Ø§Ø¨ Ù†Ù‡Ø§Ø¦ÙŠÙ‹Ø§ØŸ âŒ")) return;let u=db.users.find(x=>x.id===uid);addLog(`ğŸ—‘ï¸ ØªÙ… Ø­Ø°Ù Ø§Ù„Ø­Ø³Ø§Ø¨: ${u.char}`);db.users=db.users.filter(u=>u.id!==uid);localStorage.setItem("ivl-db",JSON.stringify(db));alert("ØªÙ… Ø­Ø°Ù Ø§Ù„Ø­Ø³Ø§Ø¨ âœ…");updateDeleteUserList();updatePointUsers();updateTopUsers();}
function renderMarket(){market.innerHTML=db.items.map(i=>`<div class="card flex justify-between p-2"><div><b>${i.name}</b><div class="text-green text-xs">${i.price} Ù†Ù‚Ø·Ø©</div><div class="text-xs text-green/70">Ø§Ù„ÙØ¦Ø©: ${i.category||'Ø¹Ø§Ù…'}</div></div><button class="btn text-sm" onclick="confirmAction('buy',${i.id})">Ø´Ø±Ø§Ø¡</button></div>`).join("");}
function confirmAction(type,id=null){modal.classList.remove("hidden");let title="",text="";switch(type){case 'buy':let item=db.items.find(x=>x.id===id);title="ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø´Ø±Ø§Ø¡";text=`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø´Ø±Ø§Ø¡ "${item.name}" Ù…Ù‚Ø§Ø¨Ù„ ${item.price} Ù†Ù‚Ø·Ø©ØŸ`;break;case 'addPoints':title="ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¥Ø¶Ø§ÙØ©";text="Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Ù‚Ø§Ø·ØŸ";break;case 'removePoints':title="ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù";text="Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ù†Ù‚Ø§Ø·ØŸ";break;case 'addItem':title="ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¥Ø¶Ø§ÙØ©";text="Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø³Ù„Ø¹Ø©ØŸ";break;}modalTitle.textContent=title;modalText.textContent=text;modalConfirm.onclick=()=>{modal.classList.add("hidden");handleAction(type,id)};modalCancel.onclick=()=>{modal.classList.add("hidden")}}
function handleAction(type,id){switch(type){case 'buy':let item=db.items.find(x=>x.id===id);if(session.points<item.price){alert("Ø±ØµÙŠØ¯Ùƒ ØºÙŠØ± ÙƒØ§ÙÙŠ");return;}session.points-=item.price;localStorage.setItem("ivl-db",JSON.stringify(db));mePoints.textContent=session.points;addLog(`ğŸ›’ ØªÙ… Ø´Ø±Ø§Ø¡: ${item.name} Ù…Ù‚Ø§Ø¨Ù„ ${item.price} Ù†Ù‚Ø·Ø©`);let msg=`*Ë¹ğŸ«€Ë¼â€¢Ø·Ù€Ù€Ù€Ù„Ù€Ù€Ù€Ø¨ Ø´Ù€Ù€Ù€Ø±Ø§Ø¡:â€¢*\n\n*âœ˜ Ø§Ù„Ù•Ù…Ù€Ø³Ù€ØªÙ€Ø®Ù€Ø¯Ù…: ã€˜ ${session.char} ã€™â€¢*\n*âœ˜ Ø§Ù„Ù€Ø³Ù€Ù„Ù€Ø¹Ù€Ø©: ã€˜ ${item.name} ã€™â€¢*\n*âœ˜ Ø§Ù„Ù€Ø³Ù€Ø¹Ù€Ø±: ã€˜ ${item.price} ã€™â€¢*\n> *ğ‘°.ğ‘½.ğ‘³  ğ– › ğŸŒ™é»’ Ø§ÙŠÙ€Ù€à¢ªÙÙ€Ø§Ù„*`;window.open("https://wa.me/963936427273?text="+encodeURIComponent(msg),"_blank");break;case 'addPoints':let uid=+pointUser.value,amt=+pointAmount.value;if(!amt||amt<=0){alert("Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… ØµØ­ÙŠØ­");return;}let u=db.users.find(x=>x.id===uid);u.points+=amt;if(u.id===session.id) mePoints.textContent=session.points;localStorage.setItem("ivl-db",JSON.stringify(db));updateTopUsers();addLog(`â• ØªÙ… Ø¥Ø¶Ø§ÙØ© ${amt} Ù†Ù‚Ø·Ø© Ù„Ù€ ${u.char}`);break;case 'removePoints':uid=+pointUser.value;amt=+pointAmount.value;if(!amt||amt<=0){alert("Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… ØµØ­ÙŠØ­");return;}u=db.users.find(x=>x.id===uid);u.points=Math.max(0,u.points-amt);if(u.id===session.id) mePoints.textContent=session.points;localStorage.setItem("ivl-db",JSON.stringify(db));updateTopUsers();addLog(`â– ØªÙ… Ø­Ø°Ù ${amt} Ù†Ù‚Ø·Ø© Ù…Ù† ${u.char}`);break;case 'addItem':let name=itemName.value.trim();let price=+itemPrice.value;let cat=itemCategory.value.trim();if(!name||!price){alert("Ø£ÙƒÙ…Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ø³Ø¹Ø±");return;}db.items.push({id:Date.now(),name,price,category:cat});localStorage.setItem("ivl-db",JSON.stringify(db));itemName.value=itemPrice.value=itemCategory.value="";renderMarket();addLog(`ğŸ†• ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø³Ù„Ø¹Ø©: ${name} Ø¨Ø³Ø¹Ø± ${price}`);break;}}
</script>

</body>
  </html>
